!function(e,n,t,i){e.fn.form=function(n,r){var o,a=e(this),s=e.extend(!0,{},e.fn.form.settings,r),l=e.extend({},e.fn.form.settings.defaults,n),u=s.namespace,d=s.metadata,c=s.selector,f=s.className,m=(s.error,"."+u),p="module-"+u,v=a.selector||"",g=(new Date).getTime(),h=[],b=arguments[0],y="string"==typeof b,z=[].slice.call(arguments,1);return a.each(function(){var n,r=e(this),u=e(this).find(c.field),k=e(this).find(c.group),w=e(this).find(c.message),x=(e(this).find(c.prompt),e(this).find(c.submit)),E=[],C=this,T=r.data(p);n={initialize:function(){n.verbose("Initializing form validation",r,l,s),n.bindEvents(),n.instantiate()},instantiate:function(){n.verbose("Storing instance of module",n),T=n,r.data(p,n)},destroy:function(){n.verbose("Destroying previous module",T),n.removeEvents(),r.removeData(p)},refresh:function(){n.verbose("Refreshing selector cache"),u=r.find(c.field)},submit:function(){n.verbose("Submitting form",r),r.submit()},bindEvents:function(){s.keyboardShortcuts&&u.on("keydown"+m,n.event.field.keydown),r.on("submit"+m,n.validate.form),u.on("blur"+m,n.event.field.blur),x.on("click"+m,n.submit),u.each(function(){var t=e(this).prop("type"),i=n.get.changeEvent(t);e(this).on(i+m,n.event.field.change)})},removeEvents:function(){r.off(m),u.off(m),x.off(m),u.off(m)},event:{field:{keydown:function(t){var i=e(this),r=t.which,o={enter:13,escape:27};return r==o.escape&&(n.verbose("Escape key pressed blurring field"),i.blur()),!t.ctrlKey&&r==o.enter&&i.is(c.input)?(n.debug("Enter key pressed, submitting form"),x.addClass(f.down),i.one("keyup"+m,n.event.field.keyup),t.preventDefault(),!1):void 0},keyup:function(){n.verbose("Doing keyboard shortcut form submit"),x.removeClass(f.down),n.submit()},blur:function(){var t=e(this),i=t.closest(k);i.hasClass(f.error)?(n.debug("Revalidating field",t,n.get.validation(t)),n.validate.field(n.get.validation(t))):("blur"==s.on||"change"==s.on)&&n.validate.field(n.get.validation(t))},change:function(){var t=e(this),i=t.closest(k);("change"==s.on||i.hasClass(f.error)&&s.revalidate)&&(clearTimeout(n.timer),n.timer=setTimeout(function(){n.debug("Revalidating field",t,n.get.validation(t)),n.validate.field(n.get.validation(t))},s.delay))}}},get:{changeEvent:function(e){return"checkbox"==e||"radio"==e||"hidden"==e?"change":t.createElement("input").oninput!==i?"input":t.createElement("input").onpropertychange!==i?"propertychange":"keyup"},field:function(t){return n.verbose("Finding field with identifier",t),u.filter("#"+t).size()>0?u.filter("#"+t):u.filter('[name="'+t+'"]').size()>0?u.filter('[name="'+t+'"]'):u.filter("[data-"+d.validate+'="'+t+'"]').size()>0?u.filter("[data-"+d.validate+'="'+t+'"]'):e("<input/>")},validation:function(t){var i;return e.each(l,function(e,r){n.get.field(r.identifier).get(0)==t.get(0)&&(i=r)}),i||!1}},has:{field:function(e){return n.verbose("Checking for existence of a field with identifier",e),u.filter("#"+e).size()>0?!0:u.filter('[name="'+e+'"]').size()>0?!0:u.filter("[data-"+d.validate+'="'+e+'"]').size()>0?!0:!1}},add:{prompt:function(t,o){var a=n.get.field(t),l=a.closest(k),u=l.find(c.prompt),d=0!==u.size();o="string"==typeof o?[o]:o,n.verbose("Adding field error state",t),l.addClass(f.error),s.inline&&(d||(u=s.templates.prompt(o),u.appendTo(l)),u.html(o[0]),d?n.verbose("Inline errors are disabled, no inline error added",t):s.transition&&e.fn.transition!==i&&r.transition("is supported")?(n.verbose("Displaying error with css transition",s.transition),u.transition(s.transition+" in",s.duration)):(n.verbose("Displaying error with fallback javascript animation"),u.fadeIn(s.duration)))},errors:function(e){n.debug("Adding form error messages",e),w.html(s.templates.error(e))}},remove:{prompt:function(t){var o=n.get.field(t.identifier),a=o.closest(k),l=a.find(c.prompt);a.removeClass(f.error),s.inline&&l.is(":visible")&&(n.verbose("Removing prompt for field",t),s.transition&&e.fn.transition!==i&&r.transition("is supported")?l.transition(s.transition+" out",s.duration,function(){l.remove()}):l.fadeOut(s.duration,function(){l.remove()}))}},validate:{form:function(t){var i=!0;return E=[],e.each(l,function(e,t){n.validate.field(t)||(i=!1)}),i?(n.debug("Form has no validation errors, submitting"),r.removeClass(f.error).addClass(f.success),e.proxy(s.onSuccess,this)(t)):(n.debug("Form has errors"),r.addClass(f.error),s.inline||n.add.errors(E),e.proxy(s.onFailure,this)(E))},field:function(t){var r=n.get.field(t.identifier),o=!0,a=[];return t.rules!==i&&e.each(t.rules,function(e,i){n.has.field(t.identifier)&&!n.validate.rule(t,i)&&(n.debug("Field is invalid",t.identifier,i.type),a.push(i.prompt),o=!1)}),o?(n.remove.prompt(t,a),e.proxy(s.onValid,r)(),!0):(E=E.concat(a),n.add.prompt(t.identifier,a),e.proxy(s.onInvalid,r)(a),!1)},rule:function(t,o){var a,l,u=n.get.field(t.identifier),d=o.type,c=e.trim(u.val()+""),f=/\[(.*)\]/i,m=f.exec(d),p=!0;return m!==i&&null!==m?(a=""+m[1],l=d.replace(m[0],""),p=e.proxy(s.rules[l],r)(c,a)):p=e.proxy(s.rules[d],u)(c),p}},setting:function(n,t){if(e.isPlainObject(n))e.extend(!0,s,n);else{if(t===i)return s[n];s[n]=t}},internal:function(t,r){if(e.isPlainObject(t))e.extend(!0,n,t);else{if(r===i)return n[t];n[t]=r}},debug:function(){s.debug&&(s.performance?n.performance.log(arguments):(n.debug=Function.prototype.bind.call(console.info,console,s.name+":"),n.debug.apply(console,arguments)))},verbose:function(){s.verbose&&s.debug&&(s.performance?n.performance.log(arguments):(n.verbose=Function.prototype.bind.call(console.info,console,s.name+":"),n.verbose.apply(console,arguments)))},error:function(){n.error=Function.prototype.bind.call(console.error,console,s.name+":"),n.error.apply(console,arguments)},performance:{log:function(e){var t,i,r;s.performance&&(t=(new Date).getTime(),r=g||t,i=t-r,g=t,h.push({Element:C,Name:e[0],Arguments:[].slice.call(e,1)||"","Execution Time":i})),clearTimeout(n.performance.timer),n.performance.timer=setTimeout(n.performance.display,100)},display:function(){var t=s.name+":",r=0;g=!1,clearTimeout(n.performance.timer),e.each(h,function(e,n){r+=n["Execution Time"]}),t+=" "+r+"ms",v&&(t+=" '"+v+"'"),a.size()>1&&(t+=" ("+a.size()+")"),(console.group!==i||console.table!==i)&&h.length>0&&(console.groupCollapsed(t),console.table?console.table(h):e.each(h,function(e,n){console.log(n.Name+": "+n["Execution Time"]+"ms")}),console.groupEnd()),h=[]}},invoke:function(n,t,r){var a,s,l,u=T;return t=t||z,r=C||r,"string"==typeof n&&u!==i&&(n=n.split(/[\. ]/),a=n.length-1,e.each(n,function(t,r){var o=t!=a?r+n[t+1].charAt(0).toUpperCase()+n[t+1].slice(1):n;if(e.isPlainObject(u[o])&&t!=a)u=u[o];else{if(u[o]!==i)return s=u[o],!1;if(!e.isPlainObject(u[r])||t==a)return u[r]!==i?(s=u[r],!1):!1;u=u[r]}})),e.isFunction(s)?l=s.apply(r,t):s!==i&&(l=s),e.isArray(o)?o.push(l):o!==i?o=[o,l]:l!==i&&(o=l),s}},y?(T===i&&n.initialize(),n.invoke(b)):(T!==i&&n.destroy(),n.initialize())}),o!==i?o:this},e.fn.form.settings={name:"Form",namespace:"form",debug:!0,verbose:!0,performance:!0,keyboardShortcuts:!0,on:"submit",inline:!1,delay:200,revalidate:!0,transition:"scale",duration:150,onValid:function(){},onInvalid:function(){},onSuccess:function(){return!0},onFailure:function(){return!1},metadata:{validate:"validate"},selector:{message:".error.message",field:"input, textarea, select",group:".field",input:"input",prompt:".prompt",submit:".submit"},className:{error:"error",success:"success",down:"down",label:"ui label prompt"},error:{method:"The method you called is not defined."},templates:{error:function(n){var t='<ul class="list">';return e.each(n,function(e,n){t+="<li>"+n+"</li>"}),t+="</ul>",e(t)},prompt:function(n){return e("<div/>").addClass("ui red pointing prompt label").html(n[0])}},rules:{checked:function(){return e(this).filter(":checked").size()>0},empty:function(e){return!(e===i||""===e)},email:function(e){var n=new RegExp("[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?","i");return n.test(e)},length:function(e,n){return e!==i?e.length>=n:!1},not:function(e,n){return e!=n},contains:function(e,n){return n=n.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),-1!==e.search(n)},is:function(e,n){return e==n},maxLength:function(e,n){return e!==i?e.length<=n:!1},match:function(n,t){var r,o=e(this);return o.find("#"+t).size()>0?r=o.find("#"+t).val():o.find("[name="+t+"]").size()>0?r=o.find("[name="+t+"]").val():o.find('[data-validate="'+t+'"]').size()>0&&(r=o.find('[data-validate="'+t+'"]').val()),r!==i?n.toString()==r.toString():!1},url:function(e){var n=/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/;return n.test(e)}}}}(jQuery,window,document);